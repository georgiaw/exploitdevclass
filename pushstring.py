#!/usr/bin/python
#port of pvepushstring.pl from Corelan.be to Python 
import os
import sys
input = sys.argv[1]
length = len(input)
count = 0
charater = ""
bytecount = 0
hexstring = ""
hexstring2 = ""
pushstring = ""
output = ""
opcodes = ""
while count < length:
      character = input[count]
      hex1 = hex(ord(character))
      hex2 = hex1[2:]
      if bytecount < 3 :
            hexstring += "\\x" + hex2
	    hexstring2 += hex2 
	    bytecount += 1
      else :
            pushstring = hexstring2 + hex2
            hexstring += "\\x" + hex2
            output = "\"" + "\\x68" + hexstring + "\"" + "      //PUSH 0x" + pushstring[6:8] + pushstring[4:6] + pushstring[2:4] + pushstring[0:2]
	    opcodes = output + "\n" + opcodes
	    hexstring = ""
	    hexstring2 = ""
	    bytecount = 0
      count += 1
if len(hexstring) > 0 :
      while len(hexstring) < 12:
             hexstring += "\\x20"
	     hexstring2 += "20"
             
      pushstring = hexstring2 + "00"
      output = "\"" + "\\x68" + hexstring + "\\x00" + "\"" + "      //PUSH 0x" + pushstring[6:8] + pushstring[4:6] + pushstring[2:4] + pushstring[0:2]
      opcodes = output + "\n" + opcodes
else :
      opcodes = "\"" + "\\x68\\x20\\x20\\x20\\x00" + "\"" + "      //PUSH 0x00202020\n" + opcodes
print opcodes

